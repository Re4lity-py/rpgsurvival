<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gamble Elite - Ultimate Casino Hub</title>
    <style>
        :root { --gold: #D4AF37; --green: #064E3B; --red: #d00; --black: #111; --bg: #0f172a; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; text-align: center; overflow-x: hidden; }
        
        .navbar { background: #1e293b; padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; border-bottom: 3px solid var(--gold); position: sticky; top: 0; z-index: 100; }
        .balance { font-size: 1.5rem; color: var(--gold); font-weight: bold; }
        .nav-btn { background: var(--gold); border: none; padding: 8px 15px; border-radius: 5px; font-weight: bold; cursor: pointer; margin-right: 5px; }
        .admin-btn { background: #dc2626; color: white; border: 1px solid #991b1b; }

        .screen { display: none; padding: 20px; animation: fadeIn 0.3s; }
        #lobby { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; padding: 40px; max-width: 1000px; margin: 0 auto; }
        .game-card { background: #1e1e1e; border: 2px solid #333; border-radius: 15px; padding: 20px; cursor: pointer; transition: 0.3s; }
        .game-card:hover { border-color: var(--gold); transform: translateY(-5px); }
        .game-card h2 { color: var(--gold); }

        .btn { background: var(--gold); border: none; padding: 12px 20px; border-radius: 5px; font-weight: bold; cursor: pointer; margin: 5px; box-shadow: 0 3px 0 #92400e; }
        .btn:active { transform: translateY(3px); box-shadow: none; }
        .btn:disabled { background: #555; box-shadow: none; opacity: 0.6; cursor: not-allowed; transform: none; }
        input { background: #000; color: white; border: 1px solid var(--gold); padding: 8px; border-radius: 5px; width: 70px; text-align: center; font-size: 1rem; }
        .status { font-size: 1.4rem; height: 40px; color: var(--gold); margin: 15px; font-weight: bold; }

        /* ROULETTE STYLES */
        .wheel-box { position: relative; display: inline-block; margin-bottom: 10px; }
        .arrow { width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 30px solid var(--gold); position: absolute; top: -10px; left: 50%; transform: translateX(-50%); z-index: 10; }
        canvas { border-radius: 50%; border: 6px solid #333; max-width: 320px; }
        .betting-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; max-width: 500px; margin: 20px auto; background: var(--green); padding: 15px; border-radius: 10px; border: 2px solid var(--gold); }
        .zone { background: rgba(0,0,0,0.5); padding: 12px; border-radius: 5px; cursor: pointer; font-size: 0.8rem; font-weight: bold; border: 1px solid transparent; }
        .zone.active { border-color: white; background: var(--gold); color: black; }

        /* BLACKJACK STYLES */
        .table { background: var(--green); border-radius: 100px 100px 20px 20px; padding: 30px 20px; border: 8px solid #3e2723; max-width: 550px; margin: 0 auto; box-shadow: inset 0 0 50px rgba(0,0,0,0.5); }
        .hand { display: flex; justify-content: center; gap: 10px; min-height: 100px; margin: 10px 0; }
        .card { background: white; color: black; width: 55px; height: 85px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.4rem; border: 1px solid #999; box-shadow: 2px 2px 5px rgba(0,0,0,0.4); }
        .card.back { background: linear-gradient(45deg, #d00, #900); color: transparent; border: 2px solid white; }
        .score-box { font-size: 1rem; background: rgba(0,0,0,0.6); padding: 5px 12px; border-radius: 20px; display: inline-block; border: 1px solid var(--gold); }

        /* MINES STYLES */
        .mines-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; max-width: 350px; margin: 20px auto; }
        .mine-tile { width: 60px; height: 60px; background: #1e293b; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; cursor: pointer; border-bottom: 4px solid #0f172a; }
        .mine-tile.revealed { background: #0f172a; border-bottom: none; }
        .mine-tile.gem { color: #4ade80; background: #064e3b; border: 1px solid #4ade80; }
        .mine-tile.bomb { color: #f87171; background: #450a0a; border: 1px solid #f87171; }

        /* SLOTS STYLES - NOUVEAU LOOK */
        .slot-machine { 
            background: linear-gradient(to bottom, #222, #000); 
            padding: 20px; 
            border-radius: 30px; 
            border: 5px solid #444; 
            display: inline-flex; 
            align-items: center;
            gap: 15px;
            box-shadow: 0 0 30px rgba(0,0,0,0.8); 
            position: relative;
            transition: box-shadow 0.2s, border-color 0.2s;
        }

        /* Bandes de lumi√®res */
        .light-strip {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .bulb {
            width: 15px; height: 15px;
            border-radius: 50%;
            background: #333;
            box-shadow: inset 1px 1px 3px rgba(0,0,0,0.8);
            transition: background 0.1s;
        }
        
        /* √âtats des lumi√®res */
        .bulb.lit-yellow { background: #fbbf24; box-shadow: 0 0 10px #fbbf24; }
        .bulb.lit-green { background: #4ade80; box-shadow: 0 0 15px #4ade80; }

        /* Animations de la machine */
        .slot-machine.active-spin {
            border-color: #fbbf24;
            box-shadow: 0 0 50px rgba(251, 191, 36, 0.4);
            animation: shakeMachine 0.5s infinite;
        }
        .slot-machine.active-win {
            border-color: #4ade80;
            box-shadow: 0 0 60px rgba(74, 222, 128, 0.6);
            animation: pulseWin 0.8s infinite;
        }

        /* Animation des rouleaux */
        .reels-container { display: flex; gap: 10px; background: #000; padding: 15px; border-radius: 10px; border: 3px solid #666; box-shadow: inset 0 0 20px black; }
        .reel { width: 80px; height: 100px; background: white; border-radius: 5px; display: flex; align-items: center; justify-content: center; font-size: 3.5rem; overflow: hidden; box-shadow: inset 0 0 10px rgba(0,0,0,0.5); position: relative; }
        .reel.spinning { 
            color: transparent; 
            background-image: linear-gradient(white 50%, #ddd 50%);
            background-size: 100% 20px;
            animation: scrollBg 0.1s linear infinite;
        }
        
        .payout-table { margin-top: 20px; font-size: 0.9rem; color: #aaa; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 10px; display: inline-block; max-width: 600px; }

        @keyframes scrollBg { 0% { background-position: 0 0; } 100% { background-position: 0 20px; } }
        @keyframes shakeMachine { 0% { transform: translate(1px, 1px); } 50% { transform: translate(-1px, -1px); } 100% { transform: translate(1px, 1px); } }
        @keyframes pulseWin { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }

        /* OVERLAYS & MODALS */
        #cheat-overlay, #daily-overlay {
            display: none;
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 9999;
            flex-direction: column; justify-content: center; align-items: center;
        }
        #cheat-msg {
            display: none; color: red; font-size: 3rem; font-weight: bold; 
            text-transform: uppercase; margin-top: 20px; animation: shake 0.5s infinite;
        }

        .daily-box {
            background: linear-gradient(135deg, #064E3B, #000);
            border: 4px solid var(--gold);
            padding: 40px; border-radius: 20px;
            text-align: center;
            box-shadow: 0 0 50px var(--gold);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .daily-amt { font-size: 3rem; font-weight: bold; color: #4ade80; display: block; margin: 10px 0; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes popIn { from { transform: scale(0); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 10% { transform: translate(-1px, -2px) rotate(-1deg); } 20% { transform: translate(-3px, 0px) rotate(1deg); } 30% { transform: translate(3px, 2px) rotate(0deg); } 40% { transform: translate(1px, -1px) rotate(1deg); } 50% { transform: translate(-1px, 2px) rotate(-1deg); } 60% { transform: translate(-3px, 1px) rotate(0deg); } 70% { transform: translate(3px, 1px) rotate(-1deg); } 80% { transform: translate(-1px, -1px) rotate(1deg); } 90% { transform: translate(1px, 2px) rotate(0deg); } 100% { transform: translate(1px, -2px) rotate(-1deg); } }
    </style>
</head>
<body>

    <div id="cheat-overlay">
        <img id="sus-img" src="sus.jpg" style="max-width: 80%; max-height: 70vh;" onerror="this.style.display='none'; document.getElementById('cheat-msg').style.display='block';">
        <div id="cheat-msg">TRICHE D√âTECT√âE !<br>Balance r√©initialis√©e.</div>
    </div>

    <div id="daily-overlay">
        <div class="daily-box">
            <h1>üìÖ BONUS JOURNALIER</h1>
            <p>Heureux de te revoir ! Voici ta r√©compense :</p>
            <span class="daily-amt">+1000 $</span>
            <button class="btn" style="font-size:1.2rem; padding: 15px 30px;" onclick="closeDaily()">R√âCUP√âRER üí∞</button>
        </div>
    </div>

    <div class="navbar">
        <div>
            <button class="nav-btn" onclick="showScreen('lobby')">üè† LOBBY</button>
            <button class="nav-btn admin-btn" onclick="openAdmin()">üîê ADMIN</button>
        </div>
        <div class="balance">üí∞ <span id="balance">...</span> $</div>
    </div>

    <div id="lobby" class="screen" style="display: grid;">
        <div class="game-card" onclick="showScreen('roulette')"><h2>üé° ROULETTE PRO</h2><p>Couleurs, Douzaines, Num√©ros</p></div>
        <div class="game-card" onclick="showScreen('blackjack')"><h2>üÉè BLACKJACK</h2><p>Battez la banque (21)</p></div>
        <div class="game-card" onclick="showScreen('mines')"><h2>üí£ MINES</h2><p>Multiplicateur x Gemmes</p></div>
        <div class="game-card" onclick="showScreen('slots')"><h2>üé∞ SLOTS 777</h2><p>Jackpot & Fruits</p></div>
    </div>

    <div id="roulette" class="screen">
        <div class="wheel-box"><div class="arrow"></div><canvas id="wheelCanvas" width="340" height="340"></canvas></div>
        <div id="resR" class="status">Faites vos jeux !</div>
        <div>Mise : <input type="number" id="betR" value="50"> <button class="btn" id="spinBtn" onclick="playRoulette()">LANCER</button></div>
        <div class="betting-grid">
            <div class="zone" onclick="setBet('RED', this)">ROUGE (x2)</div>
            <div class="zone" onclick="setBet('BLACK', this)">NOIR (x2)</div>
            <div class="zone" onclick="setBet('PAIR', this)">PAIR (x2)</div>
            <div class="zone" onclick="setBet('IMPAIR', this)">IMPAIR (x2)</div>
            <div class="zone" onclick="setBet('1-12', this)">1-12 (x3)</div>
            <div class="zone" onclick="setBet('13-24', this)">13-24 (x3)</div>
            <div class="zone" onclick="setBet('25-36', this)">25-36 (x3)</div>
            <div class="zone" onclick="setBet('NUM', this)">N¬∞ : <input type="number" id="numR" value="7" style="width:30px;"></div>
            <div class="zone" onclick="setBet('ZERO', this)">ZERO (x36)</div>
        </div>
    </div>

    <div id="blackjack" class="screen">
        <div id="resBJ" class="status">Placez votre mise</div>
        <div class="table">
            <div class="score-box">Banque: <span id="d-score">?</span></div>
            <div id="d-hand" class="hand"></div>
            <hr style="border:0; height:1px; background:rgba(255,255,255,0.1); margin:15px;">
            <div id="p-hand" class="hand"></div>
            <div class="score-box">Mon Score: <span id="p-score">0</span></div>
        </div>
        <div id="bj-ctrl-init" style="margin-top:20px;">
            Mise : <input type="number" id="betBJ" value="50">
            <button class="btn" onclick="startBJ()">DISTRIBUER</button>
        </div>
        <div id="bj-ctrl-play" style="display:none; margin-top:20px;">
            <button class="btn" onclick="hit()">TIRER</button>
            <button class="btn" onclick="stand()">RESTER</button>
            <button class="btn" id="db-btn" onclick="doubleDown()">DOUBLER</button>
        </div>
    </div>

    <div id="mines" class="screen">
        <div id="resMines" class="status">Misez pour commencer !</div>
        <div class="mines-grid" id="minesGrid"></div>
        <div style="margin-top:20px;">
            Mise : <input type="number" id="betMines" value="50"> 
            Mines : <input type="number" id="mineCount" value="3" min="1" max="24">
            <br><br>
            <button class="btn" id="startMinesBtn" onclick="startMines()">JOUER</button>
            <button class="btn" id="cashoutBtn" onclick="cashoutMines()" disabled style="background:#4ade80; color:black;">CASH OUT</button>
        </div>
    </div>

    <div id="slots" class="screen">
        <div id="resSlots" class="status">Alignez 3 symboles !</div>
        <div id="slotMachine" class="slot-machine">
            <div class="light-strip">
                <div class="bulb"></div><div class="bulb"></div><div class="bulb"></div>
                <div class="bulb"></div><div class="bulb"></div>
            </div>
            
            <div class="reels-container">
                <div class="reel" id="reel1">üçí</div>
                <div class="reel" id="reel2">üçí</div>
                <div class="reel" id="reel3">üçí</div>
            </div>

            <div class="light-strip">
                <div class="bulb"></div><div class="bulb"></div><div class="bulb"></div>
                <div class="bulb"></div><div class="bulb"></div>
            </div>
        </div>
        <div style="margin-top:25px;">
            Mise : <input type="number" id="betSlots" value="50">
            <button class="btn" id="btnSpinSlots" onclick="spinSlots()">TOURNER üé∞</button>
        </div>
        <div class="payout-table">
            <span style="color:var(--gold)">2 PAREILS : REMBOURS√â</span><br>
            üçí x3: <b>x5</b> | üçã x3: <b>x10</b> | üçá x3: <b>x20</b> | üíé x3: <b>x50</b> | 7Ô∏è‚É£ x3: <b>x100</b>
        </div>
    </div>

    <script>
    (function() {
        const SAVE_KEY = 'ge_data_x9';
        const BONUS_KEY = 'ge_last_bonus';
        const BONUS_AMOUNT = 1000;
        
        function loadBalance() {
            try {
                let saved = localStorage.getItem(SAVE_KEY);
                if (saved) return parseFloat(atob(saved)); 
            } catch(e) {}
            return 1000; 
        }

        function saveBalance(amount) {
            localStorage.setItem(SAVE_KEY, btoa(amount.toString()));
        }

        let _secureBalance = loadBalance();
        
        // --- LOGIQUE ADMIN ---
        window.openAdmin = function() {
            let pass = prompt("üîê ADMIN PANEL\nEntrez le mot de passe :");
            if (pass === "123456789") {
                let amount = prompt("üí∞ BANQUE CASINO\nCombien d'argent voulez-vous ajouter ?");
                amount = parseFloat(amount);
                if (!isNaN(amount) && amount > 0) {
                    _secureBalance += amount;
                    updateUI();
                    alert(`SUCC√àS !\n+${amount}$ ajout√©s au compte.\nBon jeu patron !`);
                } else {
                    alert("Montant invalide.");
                }
            } else {
                alert("‚ùå ERREUR : Mot de passe incorrect.");
            }
        };

        // Protection basique : Emp√™che la modification via console (window.balance = x)
        Object.defineProperty(window, 'balance', {
            get: function() { return _secureBalance; },
            set: function(val) {
                console.log("Tentative de triche d√©tect√©e !");
                triggerCheatMode();
            }
        });

        function triggerCheatMode() {
            _secureBalance = 10;
            saveBalance(_secureBalance);
            updateUI();
            const overlay = document.getElementById('cheat-overlay');
            if(overlay) {
                overlay.style.display = 'flex';
                setTimeout(() => { overlay.style.display = 'none'; }, 10000);
            }
        }

        window.closeDaily = function() {
            document.getElementById('daily-overlay').style.display = 'none';
        }

        function checkDailyBonus() {
            const now = Date.now();
            const lastBonus = localStorage.getItem(BONUS_KEY);
            const cooldown = 86400000; 

            if (!lastBonus || (now - parseInt(lastBonus) >= cooldown)) {
                _secureBalance += BONUS_AMOUNT;
                saveBalance(_secureBalance);
                updateUI();
                localStorage.setItem(BONUS_KEY, now.toString());
                document.getElementById('daily-overlay').style.display = 'flex';
            }
        }

        const secureRandom = Math.random;
        const numbers = Object.freeze([0, 32, 15, 19, 4, 21, 2, 25, 17, 34, 6, 27, 13, 36, 11, 30, 8, 23, 10, 5, 24, 16, 33, 1, 20, 14, 31, 9, 22, 18, 29, 7, 28, 12, 35, 3, 26]);
        const slotSymbols = Object.freeze(['üçí', 'üçã', 'üçá', 'üíé', '7Ô∏è‚É£']);
        const slotPayouts = Object.freeze({ 'üçí':5, 'üçã':10, 'üçá':20, 'üíé':50, '7Ô∏è‚É£':100 });

        function updateUI() { 
            const balEl = document.getElementById('balance');
            if(balEl) balEl.innerText = Math.floor(_secureBalance);
            saveBalance(_secureBalance);
        }

        window.showScreen = function(id) {
            document.querySelectorAll('.screen').forEach(s => s.style.display = 'none');
            const target = document.getElementById(id);
            if(target) target.style.display = id === 'lobby' ? 'grid' : 'block';
            if(id === 'roulette') drawWheel();
            if(id === 'slots') startSlotLights();
        };

        // --- ROULETTE LOGIC ---
        let selectedBet = null, wheelAngle = 0;
        window.setBet = function(type, el) {
            document.querySelectorAll('.zone').forEach(z => z.classList.remove('active'));
            el.classList.add('active'); selectedBet = type;
        };

        function drawWheel() {
            const canvas = document.getElementById("wheelCanvas"); 
            if(!canvas) return;
            const ctx = canvas.getContext("2d");
            const r = 170; const step = (Math.PI*2)/37;
            ctx.clearRect(0,0,340,340); ctx.save(); ctx.translate(r,r); ctx.rotate(wheelAngle); ctx.translate(-r,-r);
            for(let i=0; i<37; i++){
                ctx.beginPath(); ctx.fillStyle = numbers[i]===0?"#080":(i%2===0?"#000":"#d00");
                ctx.moveTo(r,r); ctx.arc(r,r,r, i*step, (i+1)*step); ctx.fill();
                ctx.save(); ctx.translate(r,r); ctx.rotate(i*step + step/2);
                ctx.fillStyle="white"; ctx.font="bold 12px sans-serif"; ctx.fillText(numbers[i], r-25, 5); ctx.restore();
            }
            ctx.restore();
        }

        window.playRoulette = function() {
            if(!selectedBet) return alert("S√©lectionnez une zone !");
            let bet = parseInt(document.getElementById('betR').value);
            if(isNaN(bet) || bet <= 0) return alert("Mise invalide");
            if(bet > _secureBalance) return alert("Fonds insuffisants");
            
            _secureBalance -= bet; updateUI(); 
            document.getElementById('spinBtn').disabled = true;
            
            let rot = (Math.PI*2)*(6 + secureRandom()*4);
            let start = performance.now();
            function a(t){
                let p = (t-start)/4000; if(p>1) p=1;
                let ease = 1 - Math.pow(1-p, 3);
                wheelAngle += (rot * 0.05 * (1-ease)); drawWheel();
                if(p<1) requestAnimationFrame(a);
                else finalizeRoulette(bet);
            }
            requestAnimationFrame(a);
        };

        function finalizeRoulette(bet) {
            let step = (Math.PI*2)/37;
            let idx = Math.floor(((Math.PI*1.5) - (wheelAngle % (Math.PI*2)))/step)%37;
            if(idx<0) idx+=37;
            let n = numbers[idx]; 
            let isRed = (idx%2!==0 && n!==0); 
            let mult = 0;

            if(selectedBet==='RED' && isRed) mult=2;
            else if(selectedBet==='BLACK' && !isRed && n!==0) mult=2;
            else if(selectedBet==='PAIR' && n!==0 && n%2===0) mult=2;
            else if(selectedBet==='IMPAIR' && n%2!==0) mult=2;
            else if(selectedBet==='1-12' && n>=1 && n<=12) mult=3;
            else if(selectedBet==='13-24' && n>=13 && n<=24) mult=3;
            else if(selectedBet==='25-36' && n>=25 && n<=36) mult=3;
            else if(selectedBet==='ZERO' && n===0) mult=36;
            else if(selectedBet==='NUM' && n===parseInt(document.getElementById('numR').value)) mult=36;
            
            if(mult>0){ _secureBalance += bet*mult; document.getElementById('resR').innerHTML = `<span style="color:#4ade80">GAGN√â ! Le ${n} (+${bet*mult}$)</span>`; }
            else { document.getElementById('resR').innerHTML = `<span style="color:#f87171">PERDU : Le ${n}</span>`; }
            document.getElementById('spinBtn').disabled = false; updateUI();
        }

        // --- BLACKJACK LOGIC ---
        let pH = [], dH = [], bjBet = 0, over = true;
        let deck = [];

        function createDeck() {
            const names = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
            const vals = [2,3,4,5,6,7,8,9,10,10,10,10,11];
            deck = [];
            for(let i=0; i<names.length; i++) {
                for(let suit=0; suit<4; suit++) {
                    deck.push({ n: names[i], v: vals[i] });
                }
            }
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(secureRandom() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
        }

        function drawCard() {
            if(deck.length === 0) createDeck();
            return deck.pop();
        }

        function getScore(h) {
            let s = h.reduce((a,c)=>a+c.v, 0);
            let aces = h.filter(c=>c.n==='A').length;
            while(s > 21 && aces > 0) { s -= 10; aces--; }
            return s;
        }
        function renderBJ() {
            const pD = document.getElementById('p-hand'); const dD = document.getElementById('d-hand');
            pD.innerHTML = ""; dD.innerHTML = "";
            pH.forEach(c => pD.innerHTML += `<div class="card">${c.n}</div>`);
            dH.forEach((c, i) => {
                if (i === 1 && !over) dD.innerHTML += `<div class="card back">?</div>`;
                else dD.innerHTML += `<div class="card">${c.n}</div>`;
            });
            document.getElementById('p-score').innerText = getScore(pH);
            document.getElementById('d-score').innerText = over ? getScore(dH) : dH[0].v + " + ?";
        }
        function endBJ(m, pay=0) {
            over = true; _secureBalance += pay; updateUI(); renderBJ();
            document.getElementById('resBJ').innerText = m;
            document.getElementById('bj-ctrl-init').style.display='block';
            document.getElementById('bj-ctrl-play').style.display='none';
        }
        window.startBJ = function() {
            bjBet = parseInt(document.getElementById('betBJ').value);
            if(isNaN(bjBet) || bjBet <= 0) return alert("Mise invalide");
            if(bjBet > _secureBalance) return alert("Fonds insuffisants");
            _secureBalance -= bjBet; over = false; updateUI();
            createDeck();
            pH = [drawCard(), drawCard()]; dH = [drawCard(), drawCard()];
            document.getElementById('bj-ctrl-init').style.display='none';
            document.getElementById('bj-ctrl-play').style.display='block';
            document.getElementById('resBJ').innerText = "√Ä vous de jouer...";
            renderBJ();
        };
        window.hit = function() {
            pH.push(drawCard()); renderBJ();
            if(getScore(pH) > 21) endBJ("BUST ! Perdu.");
        };
        window.stand = function() {
            over = true; while(getScore(dH) < 17) dH.push(drawCard()); renderBJ();
            let ps = getScore(pH), ds = getScore(dH);
            if(ds > 21 || ps > ds) endBJ("GAGN√â !", bjBet*2);
            else if(ps === ds) endBJ("√âGALIT√â", bjBet);
            else endBJ("LA BANQUE GAGNE.");
        };
        window.doubleDown = function() {
            if(_secureBalance < bjBet) return alert("Pas assez pour doubler");
            _secureBalance -= bjBet; bjBet *= 2; updateUI(); pH.push(drawCard()); window.stand();
        };

        // --- MINES LOGIC ---
        let minesPos = [], minesActive = false, minesBet = 0, minesRevealed = 0, currentMult = 1;
        window.startMines = function() {
            if(minesActive) return;
            minesBet = parseInt(document.getElementById('betMines').value);
            let count = parseInt(document.getElementById('mineCount').value);
            if(isNaN(minesBet) || minesBet <= 0) return alert("Mise invalide");
            if (minesBet > _secureBalance) return alert("Fonds insuffisants");
            _secureBalance -= minesBet; updateUI();
            minesPos = []; minesRevealed = 0; currentMult = 1; minesActive = true;
            while(minesPos.length < count) {
                let r = Math.floor(secureRandom() * 25);
                if(!minesPos.includes(r)) minesPos.push(r);
            }
            document.getElementById('startMinesBtn').disabled = true;
            document.getElementById('cashoutBtn').disabled = true;
            document.getElementById('resMines').innerText = "Trouvez les diamants !";
            const grid = document.getElementById('minesGrid'); grid.innerHTML = "";
            for(let i=0; i<25; i++) {
                let tile = document.createElement('div'); tile.className = 'mine-tile';
                tile.onclick = (function(index) {
                    return function() {
                        if(!minesActive || this.classList.contains('revealed')) return;
                        this.classList.add('revealed');
                        if(minesPos.includes(index)) {
                            minesActive = false; this.classList.add('bomb'); this.innerText = "üí£";
                            revealAllMines(); document.getElementById('resMines').innerText = "PERDU !";
                            document.getElementById('startMinesBtn').disabled = false;
                            document.getElementById('cashoutBtn').disabled = true;
                        } else {
                            minesRevealed++; this.classList.add('gem'); this.innerText = "üíé";
                            let mc = parseInt(document.getElementById('mineCount').value);
                            let m = 1; for(let j=0; j<minesRevealed; j++) m *= (25-j)/(25-mc-j);
                            currentMult = m * 0.98;
                            document.getElementById('resMines').innerText = `Gain : ${(minesBet * currentMult).toFixed(2)}$ (${currentMult.toFixed(2)}x)`;
                            document.getElementById('cashoutBtn').disabled = false;
                        }
                    };
                })(i);
                grid.appendChild(tile);
            }
        };
        function revealAllMines() {
            let tiles = document.getElementsByClassName('mine-tile');
            minesPos.forEach(p => { if(!tiles[p].classList.contains('bomb')) { tiles[p].innerText = "üí£"; tiles[p].style.opacity = "0.5"; }});
        }
        window.cashoutMines = function() {
            if(!minesActive) return;
            let win = minesBet * currentMult; _secureBalance += win; updateUI();
            minesActive = false; document.getElementById('resMines').innerHTML = `<span style="color:#4ade80">GAGN√â : +${win.toFixed(2)}$</span>`;
            revealAllMines(); document.getElementById('startMinesBtn').disabled = false;
            document.getElementById('cashoutBtn').disabled = true;
        };

        // --- SLOTS LOGIC (AVEC ANIMATIONS) ---
        let slotInterval = null;
        function startSlotLights() {
            if(slotInterval) clearInterval(slotInterval);
            let bulbs = document.querySelectorAll('.bulb');
            let toggle = false;
            slotInterval = setInterval(() => {
                if(document.getElementById('slotMachine').classList.contains('active-spin')) {
                    // Mode rapide (Spin)
                    bulbs.forEach(b => {
                        b.className = 'bulb ' + (Math.random()>0.5 ? 'lit-yellow' : '');
                    });
                } else if(document.getElementById('slotMachine').classList.contains('active-win')) {
                    // Mode gagnant (Vert)
                    bulbs.forEach(b => {
                        b.className = 'bulb ' + (toggle ? 'lit-green' : '');
                    });
                    toggle = !toggle;
                } else {
                    // Mode attente (lent)
                    bulbs.forEach((b, i) => {
                        if(i%2===0) b.className = 'bulb ' + (toggle ? 'lit-yellow' : '');
                        else b.className = 'bulb ' + (!toggle ? 'lit-yellow' : '');
                    });
                    toggle = !toggle;
                }
            }, 200); 
        }

        window.spinSlots = function() {
            let bet = parseInt(document.getElementById('betSlots').value);
            if(isNaN(bet) || bet <= 0) return alert("Mise invalide");
            if(bet > _secureBalance) return alert("Fonds insuffisants");
            _secureBalance -= bet; updateUI();
            
            const reels = [document.getElementById('reel1'), document.getElementById('reel2'), document.getElementById('reel3')];
            const btn = document.getElementById('btnSpinSlots');
            const res = document.getElementById('resSlots');
            const machine = document.getElementById('slotMachine');

            btn.disabled = true; res.innerText = "Bonne chance...";
            
            reels.forEach(r => r.classList.add('spinning'));
            machine.classList.add('active-spin');
            machine.classList.remove('active-win');
            
            clearInterval(slotInterval);
            let bulbs = document.querySelectorAll('.bulb');
            let fastInt = setInterval(() => {
                bulbs.forEach(b => b.className = 'bulb ' + (Math.random()>0.5 ? 'lit-yellow' : ''));
            }, 50);

            setTimeout(() => {
                clearInterval(fastInt);
                startSlotLights(); 
                
                reels.forEach(r => r.classList.remove('spinning'));
                machine.classList.remove('active-spin');

                const final = [
                    slotSymbols[Math.floor(secureRandom() * slotSymbols.length)],
                    slotSymbols[Math.floor(secureRandom() * slotSymbols.length)],
                    slotSymbols[Math.floor(secureRandom() * slotSymbols.length)]
                ];
                reels[0].innerText = final[0]; reels[1].innerText = final[1]; reels[2].innerText = final[2];
                
                if(final[0] === final[1] && final[1] === final[2]) {
                    let win = bet * slotPayouts[final[0]]; _secureBalance += win;
                    res.innerHTML = `<span style="color:#4ade80; font-size:1.6rem;">JACKPOT ${final[0]} ! +${win}$</span>`;
                    machine.classList.add('active-win');
                } else if (final[0] === final[1] || final[0] === final[2] || final[1] === final[2]) {
                    _secureBalance += bet; res.innerHTML = `<span style="color:#fbbf24; font-size:1.2rem;">2 PAREILS ! Mise rembours√©e (+${bet}$)</span>`;
                } else { res.innerHTML = `<span style="color:#f87171">Pas de chance.</span>`; }
                
                updateUI(); btn.disabled = false;
            }, 1500); 
        };

        updateUI();
        checkDailyBonus(); 
        showScreen('lobby');
    })();
    </script>
</body>
</html>
